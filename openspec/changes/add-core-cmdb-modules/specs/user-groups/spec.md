## ADDED Requirements

### Requirement: 用户群组创建
系统 SHALL 支持创建新的用户群组，用于批量管理用户和权限分配。

#### Scenario: 成功创建用户群组
- **WHEN** 管理员提供有效的群组信息（名称、描述）
- **THEN** 系统创建群组记录并返回群组 ID
- **AND** 群组信息保存到数据库
- **AND** 创建操作记录到审计日志

#### Scenario: 创建群组时缺少必填字段
- **WHEN** 管理员提交缺少必填字段（如名称）的群组信息
- **THEN** 系统返回 400 错误和字段验证错误信息

#### Scenario: 创建群组时名称重复
- **WHEN** 管理员尝试创建与现有群组同名的群组
- **THEN** 系统返回 409 冲突错误，提示名称已存在

### Requirement: 用户群组查询
系统 SHALL 支持查询和列出用户群组记录。

#### Scenario: 查询所有用户群组
- **WHEN** 管理员请求群组列表
- **THEN** 系统返回所有群组记录的分页列表
- **AND** 包含群组的基本信息（ID、名称、描述、成员数量、创建时间）

#### Scenario: 查询单个群组详情
- **WHEN** 管理员请求特定群组 ID 的详情
- **THEN** 系统返回该群组的完整信息
- **AND** 包含群组成员列表和角色列表

#### Scenario: 查询不存在的群组
- **WHEN** 管理员请求不存在的群组 ID
- **THEN** 系统返回 404 错误

### Requirement: 用户群组更新
系统 SHALL 支持更新现有用户群组的信息。

#### Scenario: 成功更新群组信息
- **WHEN** 管理员提供有效的群组 ID 和更新数据
- **THEN** 系统更新群组记录
- **AND** 返回更新后的群组信息
- **AND** 更新操作记录到审计日志

#### Scenario: 更新群组时名称重复
- **WHEN** 管理员尝试将群组名称更新为已存在的名称
- **THEN** 系统返回 409 冲突错误，提示名称已存在

#### Scenario: 更新不存在的群组
- **WHEN** 管理员尝试更新不存在的群组 ID
- **THEN** 系统返回 404 错误

### Requirement: 用户群组删除
系统 SHALL 支持删除用户群组。

#### Scenario: 成功删除群组
- **WHEN** 管理员请求删除群组
- **THEN** 系统删除群组记录
- **AND** 删除群组与成员的关联关系
- **AND** 删除群组与角色的关联关系
- **AND** 删除操作记录到审计日志
- **AND** 返回成功响应

#### Scenario: 删除不存在的群组
- **WHEN** 管理员尝试删除不存在的群组 ID
- **THEN** 系统返回 404 错误

### Requirement: 群组成员管理
系统 SHALL 支持向群组添加成员和从群组移除成员。

#### Scenario: 成功添加成员到群组
- **WHEN** 管理员请求将用户添加到群组
- **THEN** 系统创建群组成员关联记录
- **AND** 用户继承群组的所有角色和权限
- **AND** 添加操作记录到审计日志

#### Scenario: 添加已存在的成员
- **WHEN** 管理员尝试将已在群组中的用户再次添加
- **THEN** 系统返回 409 冲突错误，提示用户已在群组中

#### Scenario: 添加不存在的用户到群组
- **WHEN** 管理员尝试将不存在的用户添加到群组
- **THEN** 系统返回 404 错误，提示用户不存在

#### Scenario: 成功从群组移除成员
- **WHEN** 管理员请求从群组移除用户
- **THEN** 系统删除群组成员关联记录
- **AND** 用户失去通过该群组继承的角色和权限
- **AND** 移除操作记录到审计日志

#### Scenario: 移除不存在的成员
- **WHEN** 管理员尝试从群组移除不在群组中的用户
- **THEN** 系统返回 404 错误，提示用户不在群组中

#### Scenario: 查询群组成员列表
- **WHEN** 管理员请求群组的成员列表
- **THEN** 系统返回该群组的所有成员
- **AND** 包含成员的基本信息（ID、用户名、邮箱）

#### Scenario: 查询用户所属的群组
- **WHEN** 管理员请求用户所属的群组列表
- **THEN** 系统返回该用户所属的所有群组
- **AND** 包含群组的基本信息

